# 项目启动说明

## 环境要求

- JDK 17+
- MySQL 8.0+
- Redis 6.0+
- Maven 3.8+ (后端构建)
- Node.js 18+ (前端运行)

## 一、数据库准备

### 1. 启动 MySQL 和 Redis
确保 MySQL 和 Redis 服务已启动。

### 2. 创建数据库
```sql
CREATE DATABASE healthcare_bbc DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
```

### 3. 执行初始化脚本
```bash
# 登录 MySQL
mysql -u root -p

# 执行脚本
use healthcare_bbc;
source deploy/sql/schema.sql;
```

## 二、后端启动

### 方式1：使用 Maven（推荐）

```bash
cd healthcare-bbc/backend

# 编译打包
mvn clean package -DskipTests

# 运行
mvn spring-boot:run
```

或者运行打包后的 jar：
```bash
java -jar target/healthcare-bbc-0.0.1-SNAPSHOT.jar
```

### 方式2：使用 IDE

在 IntelliJ IDEA 或 Eclipse 中：
1. 导入 backend 项目
2. 等待 Maven 依赖下载完成
3. 运行 `HealthcareBbcApplication.java`

### 后端服务地址
- API 地址：http://localhost:8080/api/v1
- Swagger 文档：http://localhost:8080/swagger-ui.html

## 三、前端启动

```bash
cd healthcare-bbc/frontend

# 安装依赖（首次运行）
npm install

# 启动开发服务器
npm run dev
```

### 前端访问地址
- 开发服务器：http://localhost:5173 或 http://localhost:5174

## 四、功能验证

### 1. 登录页面
访问 http://localhost:5173/login
- 输入任意企业微信ID进行登录

### 2. 客服工作台
访问 http://localhost:5173/customer-service
- 查看会话列表
- 与 AI 助手交互

### 3. 侧边栏页面
访问 http://localhost:5173/sidebar
- 此页面需要在企业微信环境中使用

### 4. Swagger API 文档
访问 http://localhost:8080/swagger-ui.html
- 查看所有 API 接口
- 测试接口调用

## 五、常见问题

### 1. 前端提示 "Network Error"
**原因**：后端服务未启动
**解决**：先启动后端服务

### 2. 数据库连接失败
**原因**：MySQL 未启动或配置错误
**解决**：
- 检查 MySQL 是否运行
- 检查 application.yml 中的数据库配置

### 3. Redis 连接失败
**原因**：Redis 未启动
**解决**：启动 Redis 服务

### 4. 企业微信回调验证失败
**原因**：
- 服务器无法被公网访问
- Token 或 EncodingAESKey 配置错误

**解决**：
- 确保服务器有公网 IP
- 检查企业微信后台配置

## 六、企业微信配置

已在 `application.yml` 中配置：
- CorpID: `wwace533e386c63f72`
- AgentId: `1000007`
- Secret: `x-3ikL_1L8FpaqgMTGYmVWwcFACTwmV8gW-h7hLqIoM`
- Token: `IlXP1Nd8pFlHfcl`
- EncodingAESKey: `Tr2NfsFeAjsyKMP5e5u7HqoyNMYWeP4wyXTO5G4t0Ir`

在企业微信后台需要配置：
1. 可信域名
2. 回调 URL
3. 应用主页

详见 [部署配置指南.md](部署配置指南.md)
