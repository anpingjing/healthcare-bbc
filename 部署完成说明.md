# 🎉 部署文件生成完成！

## ✅ 已创建的文件

所有部署配置文件已生成在 `D:\traecn\企业微信项目\deploy\` 目录：

### 📋 配置文件

| 文件 | 说明 | 用途 |
|------|------|------|
| `docker-compose.yml` | Docker Compose 主配置 | 本地/自有 VPS 部署 |
| `docker-compose.railway.yml` | Railway 专用配置 | Railway 平台部署 |
| `.env.example` | 环境变量模板 | 复制为 .env 后配置 |
| `render.yaml` | Render Blueprint | Render 平台部署 |

### 🐳 Dockerfile

| 文件 | 说明 |
|------|------|
| `Dockerfile.bbc-backend` | BBC 后端镜像 |
| `Dockerfile.admin-backend` | 管理后台镜像 |
| `Dockerfile.frontend` | 前端 Nginx 镜像 |
| `Dockerfile.railway` | Railway 多合一镜像 |

### 📜 脚本和配置

| 文件 | 说明 |
|------|------|
| `deploy-oracle.sh` | Oracle Cloud 一键部署脚本 |
| `nginx.conf` | Nginx 反向代理配置 |
| `mysql-init/01-init.sql` | 数据库初始化脚本 |

### 📖 文档

| 文件 | 说明 |
|------|------|
| `README.md` | 部署总结（本文件） |
| `QUICKSTART.md` | 快速开始指南 |
| `DEPLOY.md` | 完整部署文档（ workspace 根目录） |

---

## 🚀 立即开始部署

### 选项 1：本地 Docker 部署（最快）

```powershell
# 1. 进入部署目录
cd D:\traecn\企业微信项目\deploy

# 2. 复制环境变量文件
copy .env.example .env

# 3. 编辑 .env 文件，填入企业微信配置
notepad .env

# 4. 启动所有服务
docker compose up -d

# 5. 查看状态
docker compose ps

# 6. 访问应用
# 浏览器打开：http://localhost/
```

### 选项 2：Oracle Cloud 部署（生产推荐）

1. 登录 https://cloud.oracle.com/
2. 创建 Ubuntu 24.04 ARM 实例（2-4 OCPU, 12-24GB RAM）
3. SSH 连接到服务器
4. 上传 deploy 目录到服务器
5. 执行：`sudo bash deploy-oracle.sh`
6. 配置 .env 文件
7. 启动：`docker compose up -d`

### 选项 3：Railway 部署（最简单）

1. 访问 https://railway.com/
2. 连接 GitHub 仓库
3. 选择项目
4. 配置环境变量（参考 .env.example）
5. 自动部署完成

---

## 🔐 必填配置

在 `.env` 文件中配置以下参数：

```bash
# 从企业微信后台获取
WECHAT_CORP_ID=wwace533e386c63f72
WECHAT_CORP_SECRET=你的企业密钥
WECHAT_AGENT_ID=1000007
WECHAT_TOKEN=你的 Token
WECHAT_ENCODING_AES_KEY=你的 AES 密钥

# 生成随机密钥（生产环境）
JWT_SECRET=执行：openssl rand -base64 32

# 数据库密码（修改为强密码）
MYSQL_ROOT_PASSWORD=强密码
MYSQL_PASSWORD=强密码
REDIS_PASSWORD=强密码
```

### 获取企业微信参数

1. 登录 https://work.weixin.qq.com/
2. 管理后台 → 应用管理 → 自建应用
3. 查看 Corp ID、Secret、Agent ID
4. 应用设置 → 接收消息设置 → 配置 Token 和 AES Key

---

## 📊 访问地址

部署成功后访问：

| 服务 | 地址 | 说明 |
|------|------|------|
| 前端 | http://localhost/ | Vue3 用户界面 |
| BBC API | http://localhost:8080/ | Spring Boot 后端 |
| Admin API | http://localhost:8081/ | 管理后台 API |
| Swagger | http://localhost:8080/swagger-ui.html | API 文档 |
| H2 控制台 | http://localhost:8080/h2-console | 数据库（开发环境） |

---

## 🧪 验证部署

```bash
# 1. 检查所有服务状态
docker compose ps

# 2. 查看后端日志
docker compose logs bbc-backend

# 3. 测试 API
curl http://localhost:8080/actuator/health

# 4. 检查数据库
docker exec -it healthcare-mysql mysql -u healthcare -p
> SHOW DATABASES;
> USE healthcare_admin;
> SHOW TABLES;
```

---

## 📁 项目结构

```
企业微信项目/
├── deploy/                      # 📦 部署配置（新生成）
│   ├── docker-compose.yml
│   ├── Dockerfile.*
│   ├── .env.example
│   ├── deploy-oracle.sh
│   ├── nginx.conf
│   ├── mysql-init/
│   └── *.md (文档)
├── healthcare-admin/            # 管理后台系统
│   ├── healthcare-admin-boot/
│   ├── healthcare-admin-common/
│   └── healthcare-admin-ui/
├── healthcare-bbc/              # BBC 社群系统
│   ├── backend/
│   ├── frontend/
│   └── README.md (已更新)
└── DEPLOY.md                    # 完整部署文档
```

---

## 🔧 常用命令

```bash
# 启动服务
docker compose up -d

# 停止服务
docker compose down

# 重启服务
docker compose restart

# 查看日志
docker compose logs -f

# 更新镜像
docker compose pull
docker compose up -d

# 进入容器
docker exec -it healthcare-bbc-backend sh

# 备份数据库
docker exec healthcare-mysql mysqldump -u healthcare -p healthcare_admin > backup.sql
```

---

## ⚠️ 注意事项

### 生产环境

1. ✅ 修改所有默认密码
2. ✅ 配置 HTTPS（Let's Encrypt）
3. ✅ 配置防火墙
4. ✅ 定期备份数据库
5. ✅ 监控日志和性能

### 开发环境

1. H2 数据库仅用于开发，生产使用 MySQL
2. 关闭 Swagger 文档（生产环境）
3. 使用测试企业微信账号

---

## 📞 需要帮助？

1. 查看 `QUICKSTART.md` - 快速开始指南
2. 查看 `DEPLOY.md` - 完整部署文档
3. 查看各平台官方文档

**祝部署顺利！** 🎊

---

*生成时间：2026-02-19*
*项目：企业微信医疗管理系统*
